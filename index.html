<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØµØ­Ø­ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© | Arabic Keyboard Fixer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Traditional Arabic', Arial, sans-serif;
            background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: #2d2d3d;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4a90e2;
            padding-bottom: 20px;
        }

        .header h1 {
            font-size: 2em;
            color: #4a90e2;
            margin-bottom: 10px;
        }

        .header p {
            color: #999;
            font-size: 0.95em;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4ade80;
            margin-left: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .input-section {
            margin-bottom: 30px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #e0e0e0;
        }

        textarea {
            width: 100%;
            height: 150px;
            padding: 15px;
            border: 2px solid #4a4a5e;
            border-radius: 8px;
            background: #1e1e2e;
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .char-count {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        .suggestions-section {
            background: #1e1e2e;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            min-height: 100px;
        }

        .suggestions-title {
            font-weight: 600;
            color: #4a90e2;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .suggestion-item {
            background: #2d2d3d;
            border-right: 4px solid #4a90e2;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
        }

        .suggestion-text {
            flex: 1;
        }

        .suggestion-type {
            font-size: 0.8em;
            color: #999;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .suggestion-content {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #4ade80;
            word-break: break-all;
            padding: 10px;
            background: #1e1e2e;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .confidence {
            font-size: 0.85em;
            color: #999;
        }

        .suggestion-actions {
            display: flex;
            gap: 8px;
            flex-direction: column;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .btn-fix {
            background: #4ade80;
            color: #1e1e2e;
        }

        .btn-fix:hover {
            background: #22c55e;
            transform: translateY(-2px);
        }

        .btn-copy {
            background: #4a90e2;
            color: white;
        }

        .btn-copy:hover {
            background: #3b7bc8;
            transform: translateY(-2px);
        }

        .btn-ignore {
            background: #666;
            color: #e0e0e0;
        }

        .btn-ignore:hover {
            background: #777;
        }

        .empty-state {
            text-align: center;
            color: #666;
            padding: 20px;
            font-size: 0.95em;
        }

        .keyboard-info {
            background: #4a4a5e;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            font-size: 0.9em;
            color: #999;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #4a4a5e;
            font-size: 0.85em;
            color: #666;
        }

        .history {
            background: #1e1e2e;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .history-title {
            font-weight: 600;
            color: #4a90e2;
            margin-bottom: 12px;
        }

        .history-item {
            padding: 8px 12px;
            background: #2d2d3d;
            border-radius: 4px;
            margin-bottom: 8px;
            font-size: 0.9em;
            color: #999;
            border-left: 3px solid #4a90e2;
            cursor: pointer;
            transition: background 0.3s;
        }

        .history-item:hover {
            background: #3d3d4d;
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.4em;
            }

            .suggestion-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .suggestion-actions {
                flex-direction: row;
                width: 100%;
            }

            button {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ”§ Ù…ØµØ­Ø­ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© <span class="status-indicator"></span></h1>
            <p>Ø§ÙƒØªØ¨ Ø£Ùˆ Ø§Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø®Ù„ÙˆØ· ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ÙÙˆØ±ÙŠ | âœ… ØªÙ… ØªØµØ­ÙŠØ­ Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„ØªØ­ÙˆÙŠÙ„</p>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <label for="textInput">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø®Ù„ÙˆØ·:</label>
            <textarea 
                id="textInput" 
                placeholder="Ù…Ø«Ø§Ù„: g]d la;gm td hg;jhfm fg,pm hglthjdp (Ù‡Ø°Ø§ Ù†Øµ Ø¹Ø±Ø¨ÙŠ Ø¹Ù„Ù‰ Ù„ÙˆØ­Ø© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)"
            ></textarea>
            <div class="char-count">
                Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø­Ø±Ù: <span id="charCount">0</span>
            </div>
        </div>

        <!-- Suggestions Section -->
        <div class="suggestions-section">
            <div class="suggestions-title">
                ğŸ’¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª
            </div>
            <div id="suggestionsContainer">
                <div class="empty-state">
                    Ø§Ø¨Ø¯Ø£ Ø¨ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†Øµ Ø£Ùˆ Ø§Ù„ØµÙ‚ Ù…Ø­ØªÙˆÙ‰ Ù…Ø®Ù„ÙˆØ· Ù‡Ù†Ø§...
                </div>
            </div>
        </div>

        <!-- Keyboard Info -->
        <div class="keyboard-info">
            â„¹ï¸ <strong>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù‡Ù…Ø©:</strong> ÙŠØªÙ… Ø¯Ø¹Ù… ØªØ®Ø·ÙŠØ·Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ 101 Ùˆ 102 Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©. Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠÙƒØªØ´Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø£ ÙˆÙŠÙ‚ØªØ±Ø­ Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª.
        </div>

        <!-- History -->
        <div class="history">
            <div class="history-title">ğŸ“ Ø§Ù„Ø³Ø¬Ù„ (Ø¢Ø®Ø± 5 Ø¥ØµÙ„Ø§Ø­Ø§Øª)</div>
            <div id="historyContainer">
                <div class="empty-state">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>ØªØ·Ø¨ÙŠÙ‚ Ù…ØµØ­Ø­ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© v1.0 | ÙŠÙ…ÙƒÙ† ØªØ«Ø¨ÙŠØªÙ‡Ø§ ÙƒØ¥Ø¶Ø§ÙØ© ÙÙŠ Firefox/Chrome</p>
        </div>
    </div>

    <script>
        // Keyboard Mapping (QWERTY -> Arabic 101)
        // QWERTY -> Arabic 101 (âœ… ØªÙ… Ø§Ù„ØªØµØ­ÙŠØ­)
        const qwertyToArabic101 = {
            // Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„: q w e r t y u i o p [ ]
            'q': 'Ø¶', 'w': 'Øµ', 'e': 'Ø«', 'r': 'Ù‚', 't': 'Ù', 'y': 'Øº', 'u': 'Ø¹', 'i': 'Ù‡', 'o': 'Ø®', 'p': 'Ø­', '[': 'Ø¬', ']': 'Ø¯',
            // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ: a s d f g h j k l ; '
            // âœ… ØªØµØ­ÙŠØ­: ' ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 'Ø·' ÙˆÙ„ÙŠØ³ 'Ù„'
            'a': 'Ø´', 's': 'Ø³', 'd': 'ÙŠ', 'f': 'Ø¨', 'g': 'Ù„', 'h': 'Ø§', 'j': 'Øª', 'k': 'Ù†', 'l': 'Ù…', ';': 'Ùƒ', "'": 'Ø·',
            // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø«: z x c v b n m , . /
            // âœ… ØªØµØ­ÙŠØ­Ø§Øª: b=Ù„Ø§ (ÙƒØ§Ù† Ù‘), n=Ù‰ (ÙƒØ§Ù† Ø©), m=Ø© (ÙƒØ§Ù† Ùˆ), ,=Ùˆ, .=Ø² (ÙƒØ§Ù† Ø¸), /=ØŸ (ÙƒØ§Ù† Ø·)
            'z': 'Ø¦', 'x': 'Ø¡', 'c': 'Ø¤', 'v': 'Ø±', 'b': 'Ù„Ø§', 'n': 'Ù‰', 'm': 'Ø©', ',': 'Ùˆ', '.': 'Ø²', '/': 'ØŸ',
            '`': 'Ø°'
        };

        // QWERTY -> Arabic 102 (ØªØ®Ø·ÙŠØ· Ø¹Ø±Ø¨ÙŠ Ø¨Ø¯ÙŠÙ„)
        const qwertyToArabic102 = {
            'q': 'Ù', 'w': 'Ùƒ', 'e': 'Ø¬', 'r': 'Ø¯', 't': 'Ø´', 'y': 'Øº', 'u': 'Ø³', 'i': 'Ø§', 'o': 'ÙŠ', 'p': 'Ø¨', '[': 'Øµ', ']': 'Ø¶',
            'a': 'Ù„', 's': 'Ù…', 'd': 'Ù†', 'f': 'Øª', 'g': 'Ø©', 'h': 'Ø®', 'j': 'Ù‡', 'k': 'Ø¹', 'l': 'Ù‚', ';': 'Ø·', "'": 'Ùˆ',
            'z': 'Ø¦', 'x': 'Ø¡', 'c': 'Ø¤', 'v': 'Ø±', 'b': 'Ù„Ø§', 'n': 'Ù‰', 'm': 'Ø²', ',': 'Ùˆ', '.': 'Ø²', '/': 'ØŸ',
            '`': 'Ø°'
        };

        // Reverse mapping
        const arabicToQwerty101 = {};
        Object.entries(qwertyToArabic101).forEach(([key, value]) => {
            arabicToQwerty101[value] = key;
        });

        // Arabic characters set
        const arabicChars = new Set(Object.values(qwertyToArabic101));
        const englishChars = /[a-zA-Z\[\]';,./]/;

        const textInput = document.getElementById('textInput');
        const suggestionsContainer = document.getElementById('suggestionsContainer');
        const charCountSpan = document.getElementById('charCount');
        const historyContainer = document.getElementById('historyContainer');
        let history = [];

        // Detect and fix wrong keyboard layout (Ù…Ø­Ø³Ù‘Ù† Ù„Ø¯Ø¹Ù… ØªØ®Ø·ÙŠØ·Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©)
        function detectAndFix(text) {
            if (!text.trim()) return null;

            // Count Arabic and English chars
            let arabicCount = 0, englishCount = 0;

            for (let char of text.toLowerCase()) {
                if (arabicChars.has(char)) arabicCount++;
                else if (englishChars.test(char)) englishCount++;
            }

            const suggestions = [];

            // If mostly English chars, suggest Arabic conversion
            if (englishCount > arabicCount && englishCount > text.length * 0.5) {
                // Ø­Ø§ÙˆÙ„ Arabic 101 Ùˆ Arabic 102
                const arabic101 = convertToArabic(text, qwertyToArabic101);
                const arabic102 = convertToArabic(text, qwertyToArabic102);
                
                const confidence = Math.round((englishCount / text.length) * 100);
                suggestions.push({
                    type: 'ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø¹Ø±Ø¨ÙŠ (101)',
                    text: arabic101,
                    confidence: confidence,
                    original: text
                });
                suggestions.push({
                    type: 'ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø¹Ø±Ø¨ÙŠ (102)',
                    text: arabic102,
                    confidence: confidence,
                    original: text
                });
            }

            // If mostly Arabic chars, suggest English conversion
            if (arabicCount > englishCount && arabicCount > text.length * 0.5) {
                const confidence = Math.round((arabicCount / text.length) * 100);
                suggestions.push({
                    type: 'ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ',
                    text: potentialEnglish,
                    confidence: confidence,
                    original: text
                });
            }

            return suggestions.length > 0 ? suggestions : null;
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„
        function convertToArabic(text, mapping) {
            let result = '';
            for (let char of text.toLowerCase()) {
                result += mapping[char] || char;
            }
            return result;
        }

        // Render suggestions
        function renderSuggestions(suggestions) {
            if (!suggestions || suggestions.length === 0) {
                suggestionsContainer.innerHTML = '<div class="empty-state">Ù„Ù… ÙŠØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø£Ø®Ø·Ø§Ø¡ Ù„ÙˆØ­Ø© Ù…ÙØ§ØªÙŠØ­</div>';
                return;
            }

            suggestionsContainer.innerHTML = suggestions.map((s, i) => `
                <div class="suggestion-item">
                    <div class="suggestion-text">
                        <div class="suggestion-type">${s.type}</div>
                        <div class="suggestion-content">${s.text}</div>
                        <div class="confidence">Ø¯Ù‚Ø© Ø§Ù„ÙƒØ´Ù: ${s.confidence}%</div>
                    </div>
                    <div class="suggestion-actions">
                        <button class="btn-fix" onclick="applySuggestion(${i})">âœ“ ØªØ·Ø¨ÙŠÙ‚</button>
                        <button class="btn-copy" onclick="copySuggestion('${s.text.replace(/'/g, "\\'")}')">ğŸ“‹ Ù†Ø³Ø®</button>
                    </div>
                </div>
            `).join('');
        }

        // Apply suggestion
        window.applySuggestion = function(index) {
            const text = textInput.value.trim();
            const suggestions = detectAndFix(text);
            if (suggestions && suggestions[index]) {
                const fixed = suggestions[index];
                textInput.value = fixed.text;
                addToHistory(text, fixed.text);
                detectAndFix(fixed.text);
                charCountSpan.textContent = fixed.text.length;
            }
        };

        // Copy to clipboard
        window.copySuggestion = function(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('âœ“ ØªÙ… Ø§Ù„Ù†Ø³Ø® Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©');
            });
        };

        // Add to history
        function addToHistory(original, fixed) {
            history.unshift({ original, fixed, time: new Date().toLocaleTimeString('ar-SA') });
            if (history.length > 5) history.pop();
            renderHistory();
        }

        // Render history
        function renderHistory() {
            if (history.length === 0) {
                historyContainer.innerHTML = '<div class="empty-state">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</div>';
                return;
            }

            historyContainer.innerHTML = history.map((item, i) => `
                <div class="history-item" onclick="textInput.value='${item.fixed.replace(/'/g, "\\'")}'; detectInput()">
                    <strong>${item.time}</strong> - ${item.fixed.substring(0, 50)}...
                </div>
            `).join('');
        }

        // Event listeners
        textInput.addEventListener('input', function() {
            charCountSpan.textContent = this.value.length;
            const suggestions = detectAndFix(this.value);
            renderSuggestions(suggestions);
        });

        // Paste detection
        textInput.addEventListener('paste', function(e) {
            e.preventDefault();
            const text = (e.clipboardData || window.clipboardData).getData('text');
            textInput.value = text;
            charCountSpan.textContent = text.length;
            const suggestions = detectAndFix(text);
            renderSuggestions(suggestions);
        });

        function detectInput() {
            const suggestions = detectAndFix(textInput.value);
            renderSuggestions(suggestions);
        }
    </script>
</body>
</html>